<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도서관 출입 현황</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>

    <style>
        @font-face {
            font-family: 'Dosuguan';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_three@1.0/도서관체.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Cafe24Shiningstar';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.1/Cafe24Shiningstar.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'MonoplexKRNerd-Bold';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_Monoplex-nerd@1.0/MonoplexKRNerd-Bold.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }
        .control{
            width:100%;
            height:9vh;
            text-align: center;
            font-family: 'Dosuguan';
            font-size: 1.6rem;
            line-height: 1.7rem;
        }
        .box1 {
             float:left; 
             width:49.5%; 
             height:83vh;
            text-align: center;
            border-style:solid;
            border-width: 5px;
            border-color: black;
            border-radius: 8%;
			background-color: #ECF9FF;
        }
             
        .box2 {
             display:inline-block; 
             width:49.5%; 
             height:83vh; 
             margin-left:1%;
            text-align: center;
            border-style:solid;
            border-width: 5px;
            border-color: black;
            border-radius: 8%;
			background-color: #FFE7CC;
        }

        .num{
            font-size: 1.7rem;
            font-family: 'MonoplexKRNerd-Bold';

        }

        h2 {
            font-family: 'Dosuguan';
        }
   </style>

   
</head>
<body>
   
   
   
   <body oncontextmenu="return false" style="text-align: center; background-color: #FFFBEB;">
        <div class="control"><p style="font-size: 4px;"></p><p style="margin-bottom: 0px;">원천도서관 출입자 관리 시스템</p>
        <span style="font-size: 1.3rem; font-family: 'Cafe24Shiningstar';" id="random">니코니코니</span>
    </div>
        <div class="box1">
            <br>
            <h2>신성중학교 도서관 이용자</h2>
            <p class="num" style="font-size:3rem;"><span id="mid1">0</span>명</p>
            <p>1을 눌러 입장, 2를 눌러 퇴장</p>
            <table style="margin: 0 auto; text-align: center;">
                <tr>
                    <td>
                        <h4>Today</h2>
                        <p class="num"><span id="mid2">0</span>명</p>
                    </td>
                    <td><div style="width: 3vw;"></div></td>
                    <td>
                        <h4>Yesterday</h2>
                        <p class="num"><span id="mid3">0</span>명</p>
                    </td>
                </tr>
            </table>
            
            
			<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
			<canvas id="myChart" width="50%" height="15vh"></canvas>

			
        </div>



        <div class="box2">

			<br>
            <h2>신성고등학교 도서관 이용자</h2>
            <p class="num" style="font-size:3rem;"><span id="high1">0</span>명</p>
            <p>3을 눌러 입장, 4를 눌러 퇴장</p>
            <table style="margin: 0 auto; text-align: center;">
                <tr>
                    <td>         
                        <h4>Today</h2>
                        <p class="num"><span id="high2">0</span>명</p>
                    </td>
                    <td><div style="width: 3vw;"></div></td>
                    <td>
                        <h4>Yesterday</h2>
                        <p class="num"><span id="high3">0</span>명</p>
                    </td>
                </tr>
            </table>
            
            
			<canvas id="myChart2" width="50%" height="15vh"></canvas>
		</div>
<a onclick="down();">
	<img style="height: 5vh; margin: 0 auto;" src="data:image/svg+xml;base64,PHN2ZyBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjIiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtNi44NjQgMy40MjRjLjUwMi0uMzAxIDEuMTM2LjA2MyAxLjEzNi42NDIgMCAuMjY0LS4xMzguNTA5LS4zNjUuNjQ0LTIuNDc2IDEuNDg2LTQuMTM1IDQuMTk3LTQuMTM1IDcuMjkyIDAgNC42OTEgMy44MDggOC40OTggOC40OTggOC40OThzOC40OTctMy44MDcgOC40OTctOC40OThjMC0zLjA5My0xLjY1Ni01LjgwMy00LjEzMS03LjI4OS0uMjI1LS4xMzYtLjM2NC0uMzgtLjM2NC0uNjQ0IDAtLjU4Mi42MzUtLjk0MyAxLjEzNy0uNjQyIDIuOTEgMS43NDggNC44NTggNC45MzYgNC44NTggOC41NzUgMCA1LjUxOS00LjQ3OSA5Ljk5OC05Ljk5NyA5Ljk5OHMtOS45OTgtNC40NzktOS45OTgtOS45OThjMC0zLjY0MSAxLjk1MS02LjgzIDQuODY0LTguNTc4em0uODMxIDguNTgyczIuMDI1IDIuMDIxIDMuNzc5IDMuNzc0Yy4xNDcuMTQ3LjMzOS4yMi41My4yMi4xOTIgMCAuMzg0LS4wNzMuNTMxLS4yMiAxLjc1My0xLjc1MiAzLjc3OS0zLjc3NSAzLjc3OS0zLjc3NS4xNDUtLjE0NS4yMTctLjMzNi4yMTctLjUyNiAwLS4xOTItLjA3NC0uMzg0LS4yMjEtLjUzMS0uMjkyLS4yOTMtLjc2Ni0uMjk0LTEuMDU2LS4wMDRsLTIuNSAyLjQ5OXYtMTAuNjkzYzAtLjQxNC0uMzM2LS43NS0uNzUtLjc1cy0uNzUuMzM2LS43NS43NXYxMC42OTNsLTIuNDk4LTIuNDk4Yy0uMjg5LS4yODktLjc2Mi0uMjg2LTEuMDU0LjAwNi0uMTQ3LjE0Ny0uMjIxLjMzOS0uMjIyLjUzMSAwIC4xOS4wNzEuMzguMjE1LjUyNHoiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvc3ZnPg==">
</a><!--
<a href="https://coshaman.github.io/portfolio/index.html" target="_blank" style="text-decoration: none;">
	&copy; 박성현
</a>-->

		<script>
			let today = new Date();
			let yesterday = new Date();
			yesterday = new Date(yesterday.setDate(yesterday.getDate() - 1));
			let mid = localStorage.getItem("mid");
			let high = localStorage.getItem("high");
			if(isNaN(mid) != true) { //로컬 세팅
					mid = {}
					mid[yesterday.toLocaleDateString()] = 0;
					mid[today.toLocaleDateString()] = 0;
					localStorage.setItem("mid", JSON.stringify(mid));
			}
			else{mid = JSON.parse(mid);}
			document.getElementById("mid2").innerHTML = mid[today.toLocaleDateString()]; //사용자 수 세팅
			document.getElementById("mid3").innerHTML = mid[yesterday.toLocaleDateString()];
			if(isNaN(high) != true) { //로컬 세팅
					high = {}
					high[yesterday.toLocaleDateString()] = 0;
					high[today.toLocaleDateString()] = 0;
					localStorage.setItem("high", JSON.stringify(high));
			}
			else{high = JSON.parse(high);}
			document.getElementById("high2").innerHTML = high[today.toLocaleDateString()]; //사용자 수 세팅
			document.getElementById("high3").innerHTML = high[yesterday.toLocaleDateString()];
			
				/*function noEvent() { // 새로 고침 방지
					if (event.keyCode == 116) {
						alert("새로고침을 할 수 없습니다.");
						event.keyCode = 2;
						return false;
					} else if (event.ctrlKey
							&& (event.keyCode == 78 || event.keyCode == 82)) {
						return false;
					}
				}
			document.onkeydown = noEvent;*/
			let sValue = ["내가 인생을 알게 된 것은 사람과 접촉해서가 아니라 책과 접하였기 때문이다.-A. 프랜스-","사람은 책을 만들고 책은 사람을 만든다.- 신용호 -","책은 한 권 한 권이 하나의 세계다.- W. 워즈워스 -","독서란 자기의 머리가 남의 머리로 생각하는 일이다. - 쇼펜하우어 -","니코니코니 -야자와 니코-","좋은 책을 읽는 것은 과거의 가장 뛰어난 사람들과 대화를 나누는 것과 같다. - 데카르트 -","시간이 없어서 공부하지 못한다고 하는 사람은 시간이 있어도 공부하지 못한다. - 회남자 -","독서는 충실한 인간을 만들고, 회의는 의지가 굳센 인간을 만들며, 쓰기는 정확한 인간을 만든다. - 베이컨 -","가난한 자는 책으로 말미암아 부자가 되고 부자는 책으로 말미암아 존귀해진다. - 고문진보 -","독서한 사람은 비록 걱정이 있으되 뜻이 상하지 않는다. - 순자 -","독서같이 값싸게 주어지는 영속적인 쾌락은 또 없다. - 몽테뉴 -"];
			let sPick = Math.floor(Math.random() * sValue.length);
			document.getElementById("random").innerHTML = sValue[sPick];
			
		
				window.addEventListener('keyup', count);
				function count(event) {
					
					if (event.keyCode == 49) {
						document.getElementById("mid1").innerHTML = (document.getElementById("mid1").innerHTML * 1) + 1;
						document.getElementById("mid2").innerHTML = (document.getElementById("mid2").innerHTML * 1) + 1;
						sPick = Math.floor(Math.random() * sValue.length);
						document.getElementById("random").innerHTML = sValue[sPick];
						mid[today.toLocaleDateString()] += 1;
						localStorage.setItem("mid", JSON.stringify(mid));
					}
					if (event.keyCode == 50 && document.getElementById("mid1").innerHTML * 1 >= 0) {
						document.getElementById("mid1").innerHTML = (document.getElementById("mid1").innerHTML * 1) - 1;
					}
					if (event.keyCode == 51) {
						document.getElementById("high1").innerHTML = (document.getElementById("high1").innerHTML * 1) + 1;
						document.getElementById("high2").innerHTML = (document.getElementById("high2").innerHTML * 1) + 1;
						sPick = Math.floor(Math.random() * sValue.length);
						document.getElementById("random").innerHTML = sValue[sPick];
						high[today.toLocaleDateString()] += 1;
						localStorage.setItem("high", JSON.stringify(high));
					}
					if (event.keyCode == 52  && document.getElementById("high1").innerHTML * 1 >= 0) {
						
						document.getElementById("high1").innerHTML = (document.getElementById("high1").innerHTML * 1) - 1;
					}
		
					if(document.getElementById("mid1").innerHTML * 1 < 0){
						document.getElementById("mid1").innerHTML = 0;	
					}
					if(document.getElementById("high1").innerHTML * 1 < 0){
						document.getElementById("high1").innerHTML = 0;	
					}
				}

				function down(){
					document.getElementById("downtxt").innerHTML = "";
					for (var key in mid) {
						document.getElementById("downtxt").innerHTML += (key +" : " + mid[key]+ "명\n" );
					}
					let element = document.createElement('a');
					let text = document.getElementById("downtxt").innerHTML;
					element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
					element.setAttribute('download', '중학교도서관이용자.txt');
					element.style.display = 'none'; //하이퍼링크 요소가 보이지 않도록 처리
					document.body.appendChild(element); //DOM body요소에 하이퍼링크 부착
					element.click(); //클릭 이벤트 트리거 - 이 시점에 다운로드 발생
					document.body.removeChild(element); //하이퍼링크 제거
					document.getElementById("downtxt").innerHTML = "";
					for (var key in high) {
						document.getElementById("downtxt").innerHTML += (key +" : " + high[key]+ "명\n" );
					}
					element = document.createElement('a');
					text = document.getElementById("downtxt").innerHTML;
					element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
					element.setAttribute('download', '고등학교도서관이용자.txt');
					element.style.display = 'none'; //하이퍼링크 요소가 보이지 않도록 처리
					document.body.appendChild(element); //DOM body요소에 하이퍼링크 부착
					element.click(); //클릭 이벤트 트리거 - 이 시점에 다운로드 발생
					document.body.removeChild(element); //하이퍼링크 제거
					document.getElementById("downtxt").innerHTML = "";
				}
					
				

			</script>
<div style="display:none;" id="downtxt"></div>

<script>
	let dayforcode = new Date();
var context = document
	.getElementById('myChart')
	.getContext('2d');
var myChart = new Chart(context, {
	type: 'line', // 차트의 형태
	data: { // 차트에 들어갈 데이터
		labels: [
			//x 축
			dayforcode.getDate() - 4 + '일', dayforcode.getDate() - 3 + '일', dayforcode.getDate() - 2 + '일', dayforcode.getDate() - 1 + '일', dayforcode.getDate() + '일'
		],
		datasets: [
			{ //데이터
				label: '이용자 수', //차트 제목
				fill: true, // line 형태일 때, 선 안쪽을 채우는지 안채우는지
				data: [
				mid[(new Date(dayforcode.setDate(dayforcode.getDate() - 4))).toLocaleDateString()],mid[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],mid[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],mid[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],mid[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()] //x축 label에 대응되는 데이터 값
				],
				borderColor: [
					//경계선 색상
					'blue'
				],
				borderWidth: 5 //경계선 굵기
			}/* ,
			{
				label: 'test2',
				fill: false,
				data: [
					8, 34, 12, 24
				],
				backgroundColor: 'rgb(157, 109, 12)',
				borderColor: 'rgb(157, 109, 12)'
			} */
		]
	},
	options: {
		scales: {
			yAxes: [
				{
					ticks: {
						beginAtZero: false
					}
				}
			]
		}
	}
});
  
</script>

<script>
	dayforcode = new Date();
var context = document
	.getElementById('myChart2')
	.getContext('2d');
var myChart = new Chart(context, {
	type: 'line', // 차트의 형태
	data: { // 차트에 들어갈 데이터
		labels: [
			//x 축
			dayforcode.getDate() - 4 + '일', dayforcode.getDate() - 3 + '일', dayforcode.getDate() - 2 + '일', dayforcode.getDate() - 1 + '일', dayforcode.getDate() + '일'
		],
		datasets: [
			{ //데이터
				label: '이용자 수', //차트 제목
				fill: true, // line 형태일 때, 선 안쪽을 채우는지 안채우는지
				data: [
				high[(new Date(dayforcode.setDate(dayforcode.getDate() - 4))).toLocaleDateString()],high[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],high[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],high[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()],high[(new Date(dayforcode.setDate(dayforcode.getDate() + 1))).toLocaleDateString()] //x축 label에 대응되는 데이터 값
				],
				borderColor: [
					//경계선 색상
					'red'
				],
				borderWidth: 5 //경계선 굵기
			}/* ,
			{
				label: 'test2',
				fill: false,
				data: [
					8, 34, 12, 24
				],
				backgroundColor: 'rgb(157, 109, 12)',
				borderColor: 'rgb(157, 109, 12)'
			} */
		]
	},
	options: {
		scales: {
			yAxes: [
				{
					ticks: {
						beginAtZero: false
					}
				}
			]
		}
	}
});
  
</script>
   </body>
</body>
</html>